# Configuration Nginx temporaire pour forcer les headers CORS
# À ajouter dans le bloc server de votre site Forge
# =====================================================

# Ajouter ces lignes dans le bloc server { ... } de votre configuration Nginx

# Headers CORS pour toutes les routes
add_header 'Access-Control-Allow-Origin' 'https://app.wozif.store' always;
add_header 'Access-Control-Allow-Credentials' 'true' always;
add_header 'Access-Control-Allow-Methods' 'GET, POST, PUT, DELETE, OPTIONS, PATCH' always;
add_header 'Access-Control-Allow-Headers' 'Origin, Content-Type, Accept, Authorization, X-Requested-With, X-CSRF-TOKEN, X-API-Key' always;
add_header 'Vary' 'Origin' always;

# Gestion spéciale des requêtes OPTIONS (préflight CORS)
if ($request_method = OPTIONS) {
    add_header 'Access-Control-Allow-Origin' 'https://app.wozif.store' always;
    add_header 'Access-Control-Allow-Credentials' 'true' always;
    add_header 'Access-Control-Allow-Methods' 'GET, POST, PUT, DELETE, OPTIONS, PATCH' always;
    add_header 'Access-Control-Allow-Headers' 'Origin, Content-Type, Accept, Authorization, X-Requested-With, X-CSRF-TOKEN, X-API-Key' always;
    add_header 'Access-Control-Max-Age' '86400' always;
    return 204;
}

# =====================================================
# INSTRUCTIONS D'APPLICATION
# =====================================================

# 1. Sur Forge, ouvrez votre site config Nginx
# 2. Ajoutez ces lignes dans le bloc server { ... }
# 3. Sauvegardez et rechargez Nginx : sudo service nginx reload
# 4. Testez immédiatement sur le frontend

# =====================================================
# RÉSULTAT ATTENDU
# =====================================================

# ✅ Toutes les routes auront les headers CORS
# ✅ Frontend pourra s'authentifier
# ✅ Plus de blocage CORS dans le navigateur
